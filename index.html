<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>V√≤ng Quay Cao C·∫•p</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background: linear-gradient(to right, #00b09b, #96c93d);
        }

        .container {
            text-align: center;
        }

        .wheel-wrapper {
            position: relative;
            width: 300px;
            height: 80px;
            overflow: hidden;
            border: 3px solid #333;
            border-radius: 10px;
            background: #fff;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
        }

        .wheel {
            width: 300px;
            height: auto;
            display: flex;
            flex-direction: column;
            transition: transform 4s cubic-bezier(0.17, 0.67, 0.83, 0.67);
            transform-origin: top;
            will-change: transform;
        }

        .wheel-item {
            height: 80px;
            line-height: 80px;
            text-align: center;
            border-bottom: 1px solid #ddd;
            font-size: 18px;
            background: #f9f9f9;
            padding: 0 10px;
            box-sizing: border-box;
            flex-shrink: 0;
        }

        button {
            padding: 15px 30px;
            font-size: 18px;
            cursor: pointer;
            background-color: #333;
            color: #fff;
            border: none;
            border-radius: 8px;
            transition: background-color 0.3s, transform 0.2s;
        }

        button:hover {
            background-color: #555;
        }

        button:active {
            transform: scale(0.95);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: #fff;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .modal-content h2 {
            margin: 0 0 15px;
            font-size: 24px;
            color: #333;
        }

        .modal-content p {
            font-size: 20px;
            margin: 0 0 25px;
            color: #666;
        }

        .modal-content button {
            background-color: #333;
            color: #fff;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
        }

        .modal-content button:hover {
            background-color: #555;
        }

        .history {
            margin-top: 20px;
            text-align: left;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #fff;
            max-height: 200px;
            overflow-y: auto;
        }

        .history h3 {
            margin: 0 0 10px;
            font-size: 20px;
        }

        .history ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .history li {
            font-size: 16px;
            border-bottom: 1px solid #ddd;
            padding: 5px 0;
        }

        .key-input {
            margin-bottom: 20px;
        }

        .key-input input {
            padding: 10px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 8px;
            width: 200px;
        }

        .key-input button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background-color: #333;
            color: #fff;
            border: none;
            border-radius: 8px;
            margin-left: 10px;
        }

        .key-input button:hover {
            background-color: #555;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="key-input">
            <input type="text" id="key" placeholder="Nh·∫≠p Key">
            <button onclick="validateKey()">X√°c Nh·∫≠n Key</button>
        </div>
        <div class="wheel-wrapper" id="wheel-wrapper">
            <div class="wheel" id="wheel">
                <!-- C√°c gi·∫£i th∆∞·ªüng s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
            </div>
        </div>
        <button onclick="spinWheel()" id="spin-button" style="display: none;">Quay V√≤ng</button>
        <div class="history" id="history">
            <h3>L·ªãch S·ª≠ Ph·∫ßn Th∆∞·ªüng</h3>
            <ul id="history-list">
                <!-- L·ªãch s·ª≠ ph·∫ßn th∆∞·ªüng s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
            </ul>
        </div>
    </div>
    <div class="modal" id="modal">
        <div class="modal-content">
            <h2>Ch√∫c m·ª´ng!</h2>
            <p id="modal-message"></p>
            <button onclick="closeModal()">ƒê√≥ng</button>
            <button id="prize-link-button" style="display: none;" onclick="openPrizeLink()">Nh·∫≠n Th∆∞·ªüng</button>
        </div>
    </div>
    <script>
        const prizes = [
            { name: 'Tri√™·ª• V√¢n KSTT Sƒê', link: 'https://example.com/prize1' },
            { name: 'Nak TNVT Sƒê', link: 'https://example.com/prize2' },
            { name: 'YeNa HCT Sƒê', link: 'https://example.com/prize2' },
            { name: 'But PCT Sƒê', link: 'https://example.com/prize2' },
            { name: 'Allain TSSK Sƒê', link: 'https://example.com/prize2' },
            { name: 'Yan Tanjiro Sƒê', link: 'https://example.com/prize2' },
            { name: 'Bright Toshiro Sƒê', link: 'https://example.com/prize2' },
            { name: 'Zephys SV Sƒê', link: 'https://example.com/prize2' },
            { name: 'Flo GSTH Sƒê', link: 'https://example.com/prize2' },
            { name: 'Elsu TTPH Sƒê', link: 'https://example.com/prize2' },
            { name: 'Nak LQS Sƒê', link: 'https://example.com/prize2' },
            { name: 'Allain Kirito Sƒê', link: 'https://example.com/prize2' },
            { name: 'Veres Kimono Sƒê', link: 'https://example.com/prize2' },
            { name: 'Nak BDCT Sƒê', link: 'https://example.com/prize2' },
            { name: 'But Stacia Sƒê', link: 'https://example.com/prize2' },
            { name: 'Mu Zenitsu Sƒê', link: 'https://example.com/prize2' },
            { name: 'Flo Seven Sƒê', link: 'https://example.com/prize2' },
            { name: 'Yena Wave Sƒê', link: 'https://example.com/prize2' },
            { name: 'Raz Muay Th√°i Sƒê', link: 'https://example.com/prize2' },
            { name: 'Nak Killua Sƒê', link: 'https://example.com/prize2' },
            { name: 'Keera Nezuko Sƒê', link: 'https://example.com/prize2' },
            { name: 'Quillen NTLƒê Sƒê', link: 'https://example.com/prize2' },
            { name: 'Airi TNVT Sƒê', link: 'https://example.com/prize2' },
            { name: 'Zata T√† Ph∆∞·ª£ng  Sƒê', link: 'https://example.com/prize2' },
            { name: 'Veres L∆∞u Ly Sƒê', link: 'https://example.com/prize2' },
            { name: 'Ilum KHTH Sƒê', link: 'https://example.com/prize2' },
            { name: 'Hayate TTVT Sƒê', link: 'https://example.com/prize2' },
            { name: 'Val ƒêNTT Sƒê', link: 'https://example.com/prize2' },
            { name: 'Bijan KTLK Sƒê', link: 'https://example.com/prize2' },
            { name: 'Mu Ch√≠ T√¥n  Sƒê', link: 'https://example.com/prize2' },
            { name: 'Arduin BVCG Sƒê', link: 'https://example.com/prize2' },
            { name: 'Ryoma Ultraman Sƒê', link: 'https://example.com/prize2' },
            { name: 'Mina LXYV Sƒê', link: 'https://example.com/prize2' },
            { name: 'Raz B·∫£o V≈© Sƒê', link: 'https://example.com/prize2' },
            { name: 'Lili Wave Sƒê', link: 'https://example.com/prize2' },
            { name: 'Errol Genos Sƒê', link: 'https://example.com/prize2' },
            { name: 'Paine TXBT Sƒê', link: 'https://example.com/prize2' },
            { name: 'Aoi D·∫° ∆Øng Sƒê', link: 'https://example.com/prize2' },
            { name: 'Maloch D·∫° ∆Øng Sƒê', link: 'https://example.com/prize2' },
            { name: 'Rourke B√°ch T∆∞·ªõng Sƒê', link: 'https://example.com/prize2' },
            { name: 'Dirak TrƒÉg Khuy·∫øt Sƒê', link: 'https://example.com/prize2' },
            { name: 'Erin C·ªï T√≠ch', link: 'https://example.com/prize2' },
            { name: 'Zill Tu La Sƒê', link: 'https://example.com/prize2' },
            { name: 'LuBu Ichigo Sƒê Sƒê', link: 'https://example.com/prize2' },
            { name: 'Gildur X√≠ch Long Sƒê', link: 'https://example.com/prize2' },
            { name: 'Aya C·∫ßu V·ªìng Sƒê', link: 'https://example.com/prize2' },
            { name: 'Lavi Moba Sƒê', link: 'https://example.com/prize2' },
            { name: 'Tulen Ch√≠ T√¥n Sƒê', link: 'https://example.com/prize2' },
            { name: 'Cresht B√°ch T∆∞·ªõng Sƒê', link: 'https://example.com/prize2' },
            { name: 'Ilum Thi√™n Ng∆∞ Sƒê', link: 'https://example.com/prize2' },
            { name: 'Yorn LTS Sƒê', link: 'https://example.com/prize2' },
            { name: 'Vio T·ª∑ T·ª∑ Sƒê', link: 'https://example.com/prize2' },
            { name: 'Aoi Mafia Sƒê', link: 'https://example.com/prize2' },
            { name: 'Charlotte Hexsword Sƒê', link: 'https://example.com/prize2' },
            { name: 'Cap Harley Quinn Sƒê', link: 'https://example.com/prize2' },
            { name: 'ƒêi√™u Thuy·ªÅn Th·∫•t T·ªãch Sƒê', link: 'https://example.com/prize2' },
            { name: 'Lili Th·∫ßn Long Sƒê', link: 'https://example.com/prize2' },
            { name: 'Xeniel T·∫≠n Th·∫ø Sƒê', link: 'https://example.com/prize2' },
            { name: 'Nak Si√™u Vi·ªát Sƒê', link: 'https://example.com/prize2' },
            { name: 'EnZo Kurapika Sƒê', link: 'https://example.com/prize2' },
            { name: 'Hayate D·∫° ∆Øng Sƒê', link: 'https://example.com/prize2' },
            { name: 'Veera A.I Love You Sƒê', link: 'https://example.com/prize2' },
            { name: 'Tel Y√™u H·ªì Sƒê', link: 'https://example.com/prize2' },
            { name: 'Elsu T·∫≠n Th·∫ø Sƒê', link: 'https://example.com/prize2' },
            { name: 'WuKong T·ªÅ Thi√™n Sƒê', link: 'https://example.com/prize2' },
            { name: 'Ryoma Samurai HT Sƒê', link: 'https://example.com/prize2' },
            { name: 'Lau Mi√™u ·∫¢nh Sƒê', link: 'https://example.com/prize2' },
            { name: 'Lili Anh ƒê√†o Sƒê', link: 'https://example.com/prize2' },
            { name: 'Val X·∫° Th·∫ßn Sƒê', link: 'https://example.com/prize2' },
            { name: 'Krixi Tatsumaki Sƒê', link: 'https://example.com/prize2' },
            { name: 'Ryoma Maple Frost Sƒê', link: 'https://example.com/prize2' },
            { name: 'Enzo STBH Sƒê', link: 'https://example.com/prize2' },
            { name: 'Rouie Thanh Long Sƒê', link: 'https://example.com/prize2' },
            { name: 'Alice Qu√¢n Nh·∫°c Sƒê', link: 'https://example.com/prize2' },
            { name: 'Nata Ph√∫ Qu√Ω Sƒê', link: 'https://example.com/prize2' },
            { name: 'Astrid Th·∫ßn Tr√≠ Tu·ªá Sƒê', link: 'https://example.com/prize2' },
            { name: 'Elsu Chu T∆∞·ªõc Sƒê', link: 'https://example.com/prize2' },
            { name: 'Zata S-Dreamer Sƒê', link: 'https://example.com/prize2' },
            { name: 'Nata NHYH Sƒê', link: 'https://example.com/prize2' },
            { name: 'Bijan HKCG Sƒê', link: 'https://example.com/prize2' },
            { name: 'Cap Kimono Sƒê', link: 'https://example.com/prize2' },
            { name: 'Tulen Th·∫ßn S·ª© Sƒê', link: 'https://example.com/prize2' },
            { name: 'Elando\'rr Tuxedo Sƒê', link: 'https://example.com/prize2' },
            { name: 'Fennik PTTX Sƒê', link: 'https://example.com/prize2' },
            { name: 'Omen Huy·∫øt ·∫¢nh Sƒê', link: 'https://example.com/prize2' },
            { name: 'Omen T·∫≠n Th·∫ø Sƒê', link: 'https://example.com/prize2' },
            { name: 'Zuka MH Sƒê', link: 'https://example.com/prize2' },
            { name: 'WuKong TGXD Sƒê', link: 'https://example.com/prize2' },
            { name: 'Flo Th·∫ßn Long Sƒê', link: 'https://example.com/prize2' },
            { name: 'Lubu CTLT Sƒê', link: 'https://example.com/prize2' },
            { name: 'Laville X·∫° Th·∫ßn Sƒê', link: 'https://example.com/prize2' },
            { name: 'Sinestrea Wave Sƒê', link: 'https://example.com/prize2' },
            { name: 'ƒêi√™u Thuy·ªÅn Wave Sƒê', link: 'https://example.com/prize2' },
            { name: 'Tel TNVT Sƒê', link: 'https://example.com/prize2' },
            { name: 'Vio TNVT Sƒê', link: 'https://example.com/prize2' },
            { name: 'Mu Kuchiki Sƒê', link: 'https://example.com/prize2' },
            { name: 'Lubu Robot Sƒê', link: 'https://example.com/prize2' },
            { name: 'But Nh·∫°c Rock Sƒê', link: 'https://example.com/prize2' },
            { name: 'Krixi Ph√π Th·ªßy Sƒê', link: 'https://example.com/prize2' },
            // Add all 100 prizes with unique links here
            { name: 'M·∫•t L∆∞·ª£t üåö', link: 'https://example.com/prize100' }
        ];

let keys = [];
    const usedKeys = new Set();
    const wheel = document.getElementById('wheel');
    const historyList = document.getElementById('history-list');
    let lastRotation = 0;
    let history = [];
    let prizeLink = '';

    async function loadKeys() {
        try {
            const response = await fetch('keys.json');
            const data = await response.json();
            keys = data.keys;
        } catch (error) {
            console.error('key:', error);
        }
    }

    loadKeys();

    function populateWheel() {
        wheel.innerHTML = '';
        prizes.forEach(prize => {
            const item = document.createElement('div');
            item.className = 'wheel-item';
            item.textContent = prize.name;
            wheel.appendChild(item);
        });
    }

    function validateKey() {
        const key = document.getElementById('key').value.trim();
        console.log('Key:', key); 
        console.log('Ds key:', keys); 

        if (key === '') {
            alert('Vui l√≤ng nh·∫≠p key.');
            return;
        }

        if (keys.includes(key) && !usedKeys.has(key)) {
            usedKeys.add(key);
            document.getElementById('spin-button').style.display = 'inline-block';
            document.querySelector('.key-input').style.display = 'none';
        } else {
            alert('Key sai ho·∫∑c ƒë√£ ƒë∆∞·ª£c s·ª≠ d·ª•ng. Vui l√≤ng ki·ªÉm tra l·∫°i.');
        }
    }


        function spinWheel() {
            const totalItems = prizes.length;
            const randomIndex = Math.floor(Math.random() * totalItems);
            const itemHeight = 80; // Height of each prize item
            const spins = 10; // Number of complete rotations before landing
            const totalHeight = itemHeight * totalItems;
            const angle = (360 * spins) + (totalHeight + (itemHeight * randomIndex));
            
            // Ensure that angle is always increasing for smooth rotation
            lastRotation += angle;
            wheel.style.transform = `translateY(-${lastRotation}px)`;

            // Set a delay to show the result after the spinning animation ends
            setTimeout(() => {
                prizeLink = prizes[randomIndex].link;
                showModal(prizes[randomIndex].name);
                updateHistory(prizes[randomIndex].name);
                resetWheel();
                document.getElementById('spin-button').style.display = 'none';
                document.querySelector('.key-input').style.display = 'block';
            }, 4000); // 4s for the spinning duration
        }

        function resetWheel() {
            setTimeout(() => {
                wheel.style.transition = 'none';
                wheel.style.transform = 'translateY(0px)';
                wheel.offsetHeight; // Trigger a reflow to restart transition
                wheel.style.transition = 'transform 4s cubic-bezier(0.17, 0.67, 0.83, 0.67)';
                lastRotation = 0; // Reset rotation for next spin
            }, 500); // Delay for wheel reset
        }

        function showModal(prize) {
            const modal = document.getElementById('modal');
            const modalMessage = document.getElementById('modal-message');
            modalMessage.textContent = `B·∫°n ƒë√£ tr√∫ng ${prize}.`;
            document.getElementById('prize-link-button').style.display = 'inline-block';
            modal.style.display = 'flex';
        }

        function closeModal() {
            const modal = document.getElementById('modal');
            modal.style.display = 'none';
        }

        function openPrizeLink() {
            window.location.href = prizeLink;
        }

        function updateHistory(prize) {
            history.unshift(prize); // Add the new prize to the beginning of the history
            if (history.length > 10) {
                history.pop(); // Remove the oldest prize if more than 10
            }
            historyList.innerHTML = history.map(p => `<li>${p}</li>`).join('');
        }

        populateWheel();
    </script>
</body>
</html>